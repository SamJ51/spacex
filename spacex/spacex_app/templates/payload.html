{% extends "base.html" %}

{% block content %}
<h1 class="heading">SpaceX Payloads</h1>

<div class="class-structure">
  {% for p in payloads %}
  <div class="card">
    <div class="card-body">
      <h2 class="card-title">{{ p.name|default:"Unnamed payload" }}</h2>

      <!-- Quick facts -->
      <ul class="meta-list">
        <li><strong>Type:</strong> {{ p.type|default:"—" }}</li>
        <li><strong>Reused:</strong> {{ p.reused|yesno:"Yes,No,Unknown" }}</li>
        <li><strong>Customers:</strong> {% if p.customers %}{{ p.customers|join:", " }}{% else %}—{% endif %}</li>
        <li><strong>Manufacturers:</strong> {% if p.manufacturers %}{{ p.manufacturers|join:", " }}{% else %}—{% endif%}</li>
        <li><strong>Nationalities:</strong> {% if p.nationalities %}{{ p.nationalities|join:", " }}{% else %}—{% endif%}</li>
        <li><strong>NORAD IDs:</strong> {% if p.norad_ids %}{{ p.norad_ids|join:", " }}{% else %}—{% endif %}</li>
      </ul>

      <!-- Mass -->
      <div class="kv" aria-label="Mass">
        <p><strong>Mass (kg)</strong>{{ p.mass_kg|default:"—" }}</p>
        <p><strong>Mass (lbs)</strong>{{ p.mass_lbs|default:"—" }}</p>
      </div>

      <!-- Orbit -->
      <div class="kv" aria-label="Orbit">
        <p><strong>Orbit</strong>{{ p.orbit|default:"—" }}</p>
        <p><strong>Ref. System</strong>{{ p.reference_system|default:"—" }}</p>
        <p><strong>Regime</strong>{{ p.regime|default:"—" }}</p>
        <p><strong>Longitude</strong>{{ p.longitude|default:"—" }}</p>
      </div>

      <!-- Orbital Parameters -->
      <details>
        <summary>Orbital parameters</summary>
        <div class="kv" aria-label="Orbital parameters">
          <p><strong>Semi-major Axis (km)</strong>{{ p.semi_major_axis_km|default:"—" }}</p>
          <p><strong>Eccentricity</strong>{{ p.eccentricity|default:"—" }}</p>
          <p><strong>Periapsis (km)</strong>{{ p.periapsis_km|default:"—" }}</p>
          <p><strong>Apoapsis (km)</strong>{{ p.apoapsis_km|default:"—" }}</p>
          <p><strong>Inclination (°)</strong>{{ p.inclination_deg|default:"—" }}</p>
          <p><strong>Period (min)</strong>{{ p.period_min|default:"—" }}</p>
          <p><strong>Lifespan (years)</strong>{{ p.lifespan_years|default:"—" }}</p>
          <p><strong>Epoch (UTC)</strong>{{ p.epoch|slice:":19"|default:"—" }}</p>
          <p><strong>Mean Motion</strong>{{ p.mean_motion|default:"—" }}</p>
          <p><strong>RAAN (°)</strong>{{ p.raan|default:"—" }}</p>
          <p><strong>Arg. of Pericenter (°)</strong>{{ p.arg_of_pericenter|default:"—" }}</p>
          <p><strong>Mean Anomaly (°)</strong>{{ p.mean_anomaly|default:"—" }}</p>
        </div>
      </details>

      <!-- Dragon subsection -->
      {% if p.dragon %}
      {% with d=p.dragon %}
      <details>
        <summary>Dragon</summary>
        <ul class="meta-list">
          <li><strong>Capsule ID:</strong> {{ d.capsule|default:"—" }}</li>
          <li><strong>Flight Time (sec):</strong> {{ d.flight_time_sec|default:"—" }}</li>
          <li><strong>Mass Returned (kg):</strong> {{ d.mass_returned_kg|default:"—" }}</li>
          <li><strong>Mass Returned (lbs):</strong> {{ d.mass_returned_lbs|default:"—" }}</li>
          <li>
            <strong>Manifest:</strong>
            {% if d.manifest %}
            <a class="btn-link" href="{{ d.manifest }}" target="_blank" rel="noopener">Open manifest</a>
            {% else %}—{% endif %}
          </li>
          <li><strong>Water Landing:</strong> {{ d.water_landing|yesno:"Yes,No,Unknown" }}</li>
          <li><strong>Land Landing:</strong> {{ d.land_landing|yesno:"Yes,No,Unknown" }}</li>
        </ul>
      </details>
      {% endwith %}
      {% endif %}

      <!-- Entities / IDs -->
      <div class="kv" aria-label="Entities / IDs">
        <p><strong>Payload ID</strong>{{ p.id|default:"—" }}</p>
        <p><strong>Launch ID</strong>{{ p.launch|default:"—" }}</p>
      </div>
    </div>
  </div>
  {% empty %}
  <p>No payload data available.</p>
  {% endfor %}
</div>
{% endblock %}